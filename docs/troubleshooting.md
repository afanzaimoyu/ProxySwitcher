# 故障排查指南

---

## 1. 安装服务时报 Access is denied

原因：

- 未使用管理员权限运行命令行

解决：

- 右键 PowerShell / CMD
- 选择“以管理员身份运行”

---

## 2. 代理已切换，但浏览器无变化

可能原因：

- 安全软件拦截注册表写入
- 系统代理被第三方工具接管

排查建议：

- 检查安全软件日志
- 暂时关闭代理管理类工具
- 确认系统代理设置是否被锁定

---

## 3. 服务启动后立即退出

可能原因：

- 代理地址配置错误
- 系统 API 调用失败

排查建议：

- 使用 `-debug` 前台运行查看日志
- 确认代理地址格式正确

---

## 4. 网络识别不符合预期

可能原因：

- 虚拟网卡（VPN / Docker）干扰
- 网络环境较复杂

排查建议：

- 查看 debug 日志中打印的网卡快照
- 确认接口类型识别结果

---

## 5. 如何完全恢复系统状态？

执行：

```powershell
ProxySwitcher.exe -uninstall
```
该命令将：

- 停止服务

- 清理注册表代理配置

- 删除相关资源